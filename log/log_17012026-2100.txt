# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(5, 3), columns=['COST_ID', 'COST_CODE', 'VENDOR'])
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(5, 3)

 COST_ID                  COST_CODE VENDOR
    1001  SCL*Robi-LP-001855-1*BH*2    SCL
    1002 SCL*Robi-LP-001855-6*MBH*1    SCL
    1003 SCL*Robi-LP-001855-7*MBH*1    SCL
    1004 SCL*Robi-LP-001855-7*MBH*2    SCL
    1005 SCL*Robi-LP-001855-3*MBH*1    SCL
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 5
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 5
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (   COST_ID                   COST_CODE VENDOR
0     1001   SCL*Robi-LP-001855-1*BH*2    SCL
1     1002  SCL*Robi-LP-001855-6*MBH*1    SCL
2     1003  SCL*Robi-LP-001855-7*MBH*1    SCL
3     1004  SCL*Robi-LP-001855-7*MBH*2    SCL
4     1005  SCL*Robi-LP-001855-3*MBH*1    SCL, {'COST_ID': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'COST_CODE': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'VENDOR': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}})
------------------------------------------
# utils.crud_v2 - auto_insert (START)
- inputs:
  engine: SQLAlchemyEngine(url=sqlite:///opflow.db)
  data: DataFrame(shape=(5, 3), columns=['cost_id', 'cost_code', 'vendor'])
  table: test_quota
  chunk_size: 10000
  add_missing_cols: False
  failure_threshold: 1
  semantic_meta: {'COST_CODE': 'STRING_OBJECT', 'VENDOR': 'STRING_OBJECT'}
  trace_sql: False

# utils.crud_v2 - auto_insert (SUCCESS)
- outputs:
  5
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(33, 16)

 COST_ID                  COST_CODE VENDOR         CONTRACT LINK_TYPE  BUCKET  MIN_CAPACITY  MAX_CAPACITY  UNIT_COST_PER_MBPS_MONTHLY  MINSLAB  LOCKIN_MONTHS          REMARKS EFFECTIVE_START_TIME EFFECTIVE_END_TIME  IS_CURRENT  CREATED_BY
    1001  SCL*Robi-LP-001855-1*BH*2    SCL Robi-LP-001855-1        BH       2             1           100                       30.00    70000              1 No per mbps rate            9/12/2024           1/1/1970           1         NaN
    1002 SCL*Robi-LP-001855-6*MBH*1    SCL Robi-LP-001855-6       MBH       1             1        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1003 SCL*Robi-LP-001855-7*MBH*1    SCL Robi-LP-001855-7       MBH       1         10000         20000                       78.26        0             12              NaN            9/12/2024           1/1/1970           1         NaN
    1004 SCL*Robi-LP-001855-7*MBH*2    SCL Robi-LP-001855-7       MBH       2         10000         20000                       78.26        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1005 SCL*Robi-LP-001855-3*MBH*1    SCL Robi-LP-001855-3       MBH       1         10000        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
... (28 more rows)
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_CONTRACT

{
  "column": "CONTRACT",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_LINK_TYPE

{
  "column": "LINK_TYPE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_REMARKS

{
  "column": "REMARKS",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 8
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "CONTRACT": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "LINK_TYPE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "BUCKET": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MIN_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MAX_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "UNIT_COST_PER_MBPS_MONTHLY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  },
  "MINSLAB": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "LOCKIN_MONTHS": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "REMARKS": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_START_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "EFFECTIVE_END_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "IS_CURRENT": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "CREATED_BY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (    COST_ID                     COST_CODE  ... IS_CURRENT CREATED_BY
0      1001     SCL*Robi-LP-001855-1*BH*2  ...          1        NaN
1      1002    SCL*Robi-LP-001855-6*MBH*1  ...          1        NaN
2      1003    SCL*Robi-LP-001855-7*MBH*1  ...          1        NaN
3      1004    SCL*Robi-LP-001855-7*MBH*2  ...          1        NaN
4      1005    SCL*Robi-LP-001855-3*MBH*1  ...          1        NaN
5      1006    FHL*ROBI-TH-LP-230030*BH*3  ...          1        NaN
6      1007    FHL*ROBI-TH-LP-230030*BH*2  ...          1        NaN
7      1008    FHL*ROBI-TH-LP-230030*LM*2  ...          1        NaN
8      1009    FHL*ROBI-TH-LP-230030*LM*3  ...          1        NaN
9      1010    FHL*ROBI-TH-LP-230030*BH*1  ...          1        NaN
10     1011    FHL*ROBI-TH-LP-230030*LM*1  ...          1        NaN
11     1012     FHL*Robi-LP-001358-5*BH*1  ...          1        NaN
12     1013     FHL*Robi-LP-001358-5*BH*2  ...          1        NaN
13     1014     FHL*Robi-LP-001358-5*BH*3  ...          1        NaN
14     1015     FHL*Robi-LP-001358-5*LM*1  ...          1        NaN
15     1016     FHL*Robi-LP-001358-5*LM*2  ...          1        NaN
16     1017     FHL*Robi-LP-001358-5*LM*3  ...          1        NaN
17     1018     SCL*Robi-LP-001855-4*BH*1  ...          1        NaN
18     1019     SCL*Robi-LP-001855-4*BH*2  ...          1        NaN
19     1020     SCL*Robi-LP-001855-4*LM*1  ...          1        NaN
20     1021     SCL*Robi-LP-001091-3*BH*1  ...          1        NaN
21     1022     SCL*Robi-LP-001091-3*LM*1  ...          1        NaN
22     1023     FHL*Robi-LP-001090-3*LM*1  ...          1        NaN
23     1024     FHL*Robi-LP-001090-3*LM*2  ...          1        NaN
24     1025     FHL*Robi-LP-001090-3*BH*3  ...          1        NaN
25     1026     SCL*Robi-LP-001855-1*BH*1  ...          1        NaN
26     1027     FHL*Robi-LP-001358-3*BH*1  ...          1        NaN
27     1028   SCL*Robi-LP-001855-7-1*LM*1  ...          1        Na...
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(33, 16)

 COST_ID                  COST_CODE VENDOR         CONTRACT LINK_TYPE  BUCKET  MIN_CAPACITY  MAX_CAPACITY  UNIT_COST_PER_MBPS_MONTHLY  MINSLAB  LOCKIN_MONTHS          REMARKS EFFECTIVE_START_TIME EFFECTIVE_END_TIME  IS_CURRENT  CREATED_BY
    1001  SCL*Robi-LP-001855-1*BH*2    SCL Robi-LP-001855-1        BH       2             1           100                       30.00    70000              1 No per mbps rate            9/12/2024           1/1/1970           1         NaN
    1002 SCL*Robi-LP-001855-6*MBH*1    SCL Robi-LP-001855-6       MBH       1             1        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1003 SCL*Robi-LP-001855-7*MBH*1    SCL Robi-LP-001855-7       MBH       1         10000         20000                       78.26        0             12              NaN            9/12/2024           1/1/1970           1         NaN
    1004 SCL*Robi-LP-001855-7*MBH*2    SCL Robi-LP-001855-7       MBH       2         10000         20000                       78.26        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1005 SCL*Robi-LP-001855-3*MBH*1    SCL Robi-LP-001855-3       MBH       1         10000        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
... (28 more rows)
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_CONTRACT

{
  "column": "CONTRACT",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_LINK_TYPE

{
  "column": "LINK_TYPE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_REMARKS

{
  "column": "REMARKS",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 8
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "CONTRACT": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "LINK_TYPE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "BUCKET": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MIN_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MAX_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "UNIT_COST_PER_MBPS_MONTHLY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  },
  "MINSLAB": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "LOCKIN_MONTHS": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "REMARKS": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_START_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "EFFECTIVE_END_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "IS_CURRENT": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "CREATED_BY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (    COST_ID                     COST_CODE  ... IS_CURRENT CREATED_BY
0      1001     SCL*Robi-LP-001855-1*BH*2  ...          1        NaN
1      1002    SCL*Robi-LP-001855-6*MBH*1  ...          1        NaN
2      1003    SCL*Robi-LP-001855-7*MBH*1  ...          1        NaN
3      1004    SCL*Robi-LP-001855-7*MBH*2  ...          1        NaN
4      1005    SCL*Robi-LP-001855-3*MBH*1  ...          1        NaN
5      1006    FHL*ROBI-TH-LP-230030*BH*3  ...          1        NaN
6      1007    FHL*ROBI-TH-LP-230030*BH*2  ...          1        NaN
7      1008    FHL*ROBI-TH-LP-230030*LM*2  ...          1        NaN
8      1009    FHL*ROBI-TH-LP-230030*LM*3  ...          1        NaN
9      1010    FHL*ROBI-TH-LP-230030*BH*1  ...          1        NaN
10     1011    FHL*ROBI-TH-LP-230030*LM*1  ...          1        NaN
11     1012     FHL*Robi-LP-001358-5*BH*1  ...          1        NaN
12     1013     FHL*Robi-LP-001358-5*BH*2  ...          1        NaN
13     1014     FHL*Robi-LP-001358-5*BH*3  ...          1        NaN
14     1015     FHL*Robi-LP-001358-5*LM*1  ...          1        NaN
15     1016     FHL*Robi-LP-001358-5*LM*2  ...          1        NaN
16     1017     FHL*Robi-LP-001358-5*LM*3  ...          1        NaN
17     1018     SCL*Robi-LP-001855-4*BH*1  ...          1        NaN
18     1019     SCL*Robi-LP-001855-4*BH*2  ...          1        NaN
19     1020     SCL*Robi-LP-001855-4*LM*1  ...          1        NaN
20     1021     SCL*Robi-LP-001091-3*BH*1  ...          1        NaN
21     1022     SCL*Robi-LP-001091-3*LM*1  ...          1        NaN
22     1023     FHL*Robi-LP-001090-3*LM*1  ...          1        NaN
23     1024     FHL*Robi-LP-001090-3*LM*2  ...          1        NaN
24     1025     FHL*Robi-LP-001090-3*BH*3  ...          1        NaN
25     1026     SCL*Robi-LP-001855-1*BH*1  ...          1        NaN
26     1027     FHL*Robi-LP-001358-3*BH*1  ...          1        NaN
27     1028   SCL*Robi-LP-001855-7-1*LM*1  ...          1        Na...
------------------------------------------
# utils.crud_v2 - auto_upsert (START)
- inputs:
  engine: SQLAlchemyEngine(url=sqlite:///opflow.db)
  data: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  table: test_quota
  constrain: ['COST_ID']
  chunk: 10000
  add_missing_cols: False
  failure_threshold: 1
  semantic_meta: {'COST_CODE': 'STRING_OBJECT', 'VENDOR': 'STRING_OBJECT', 'CONTRACT': 'STRING_OBJECT', 'LINK_TYPE': 'STRING_OBJECT', 'REMARKS': 'STRING_OBJECT'}
  trace_sql: False

# utils.crud_v2 - auto_upsert (FAILURE)
- error: ValueError: constrain=['COST_ID'] does not match any primary/unique key on 'test_quota'. Upsert requires a unique constraint to be safe.
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(33, 16)

 COST_ID                  COST_CODE VENDOR         CONTRACT LINK_TYPE  BUCKET  MIN_CAPACITY  MAX_CAPACITY  UNIT_COST_PER_MBPS_MONTHLY  MINSLAB  LOCKIN_MONTHS          REMARKS EFFECTIVE_START_TIME EFFECTIVE_END_TIME  IS_CURRENT  CREATED_BY
    1001  SCL*Robi-LP-001855-1*BH*2    SCL Robi-LP-001855-1        BH       2             1           100                       30.00    70000              1 No per mbps rate            9/12/2024           1/1/1970           1         NaN
    1002 SCL*Robi-LP-001855-6*MBH*1    SCL Robi-LP-001855-6       MBH       1             1        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1003 SCL*Robi-LP-001855-7*MBH*1    SCL Robi-LP-001855-7       MBH       1         10000         20000                       78.26        0             12              NaN            9/12/2024           1/1/1970           1         NaN
    1004 SCL*Robi-LP-001855-7*MBH*2    SCL Robi-LP-001855-7       MBH       2         10000         20000                       78.26        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1005 SCL*Robi-LP-001855-3*MBH*1    SCL Robi-LP-001855-3       MBH       1         10000        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
... (28 more rows)
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_CONTRACT

{
  "column": "CONTRACT",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_LINK_TYPE

{
  "column": "LINK_TYPE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_REMARKS

{
  "column": "REMARKS",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 8
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "CONTRACT": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "LINK_TYPE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "BUCKET": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MIN_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MAX_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "UNIT_COST_PER_MBPS_MONTHLY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  },
  "MINSLAB": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "LOCKIN_MONTHS": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "REMARKS": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_START_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "EFFECTIVE_END_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "IS_CURRENT": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "CREATED_BY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (    COST_ID                     COST_CODE  ... IS_CURRENT CREATED_BY
0      1001     SCL*Robi-LP-001855-1*BH*2  ...          1        NaN
1      1002    SCL*Robi-LP-001855-6*MBH*1  ...          1        NaN
2      1003    SCL*Robi-LP-001855-7*MBH*1  ...          1        NaN
3      1004    SCL*Robi-LP-001855-7*MBH*2  ...          1        NaN
4      1005    SCL*Robi-LP-001855-3*MBH*1  ...          1        NaN
5      1006    FHL*ROBI-TH-LP-230030*BH*3  ...          1        NaN
6      1007    FHL*ROBI-TH-LP-230030*BH*2  ...          1        NaN
7      1008    FHL*ROBI-TH-LP-230030*LM*2  ...          1        NaN
8      1009    FHL*ROBI-TH-LP-230030*LM*3  ...          1        NaN
9      1010    FHL*ROBI-TH-LP-230030*BH*1  ...          1        NaN
10     1011    FHL*ROBI-TH-LP-230030*LM*1  ...          1        NaN
11     1012     FHL*Robi-LP-001358-5*BH*1  ...          1        NaN
12     1013     FHL*Robi-LP-001358-5*BH*2  ...          1        NaN
13     1014     FHL*Robi-LP-001358-5*BH*3  ...          1        NaN
14     1015     FHL*Robi-LP-001358-5*LM*1  ...          1        NaN
15     1016     FHL*Robi-LP-001358-5*LM*2  ...          1        NaN
16     1017     FHL*Robi-LP-001358-5*LM*3  ...          1        NaN
17     1018     SCL*Robi-LP-001855-4*BH*1  ...          1        NaN
18     1019     SCL*Robi-LP-001855-4*BH*2  ...          1        NaN
19     1020     SCL*Robi-LP-001855-4*LM*1  ...          1        NaN
20     1021     SCL*Robi-LP-001091-3*BH*1  ...          1        NaN
21     1022     SCL*Robi-LP-001091-3*LM*1  ...          1        NaN
22     1023     FHL*Robi-LP-001090-3*LM*1  ...          1        NaN
23     1024     FHL*Robi-LP-001090-3*LM*2  ...          1        NaN
24     1025     FHL*Robi-LP-001090-3*BH*3  ...          1        NaN
25     1026     SCL*Robi-LP-001855-1*BH*1  ...          1        NaN
26     1027     FHL*Robi-LP-001358-3*BH*1  ...          1        NaN
27     1028   SCL*Robi-LP-001855-7-1*LM*1  ...          1        Na...
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(33, 16)

 COST_ID                  COST_CODE VENDOR         CONTRACT LINK_TYPE  BUCKET  MIN_CAPACITY  MAX_CAPACITY  UNIT_COST_PER_MBPS_MONTHLY  MINSLAB  LOCKIN_MONTHS          REMARKS EFFECTIVE_START_TIME EFFECTIVE_END_TIME  IS_CURRENT  CREATED_BY
    1001  SCL*Robi-LP-001855-1*BH*2    SCL Robi-LP-001855-1        BH       2             1           100                       30.00    70000              1 No per mbps rate            9/12/2024           1/1/1970           1         NaN
    1002 SCL*Robi-LP-001855-6*MBH*1    SCL Robi-LP-001855-6       MBH       1             1        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1003 SCL*Robi-LP-001855-7*MBH*1    SCL Robi-LP-001855-7       MBH       1         10000         20000                       78.26        0             12              NaN            9/12/2024           1/1/1970           1         NaN
    1004 SCL*Robi-LP-001855-7*MBH*2    SCL Robi-LP-001855-7       MBH       2         10000         20000                       78.26        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1005 SCL*Robi-LP-001855-3*MBH*1    SCL Robi-LP-001855-3       MBH       1         10000        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
... (28 more rows)
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_CONTRACT

{
  "column": "CONTRACT",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_LINK_TYPE

{
  "column": "LINK_TYPE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_REMARKS

{
  "column": "REMARKS",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 8
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "CONTRACT": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "LINK_TYPE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "BUCKET": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MIN_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MAX_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "UNIT_COST_PER_MBPS_MONTHLY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  },
  "MINSLAB": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "LOCKIN_MONTHS": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "REMARKS": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_START_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "EFFECTIVE_END_TIME": {
    "input_dtype": "object",
    "output_dtype": "datetime64[ns]"
  },
  "IS_CURRENT": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "CREATED_BY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (    COST_ID                     COST_CODE  ... IS_CURRENT CREATED_BY
0      1001     SCL*Robi-LP-001855-1*BH*2  ...          1        NaN
1      1002    SCL*Robi-LP-001855-6*MBH*1  ...          1        NaN
2      1003    SCL*Robi-LP-001855-7*MBH*1  ...          1        NaN
3      1004    SCL*Robi-LP-001855-7*MBH*2  ...          1        NaN
4      1005    SCL*Robi-LP-001855-3*MBH*1  ...          1        NaN
5      1006    FHL*ROBI-TH-LP-230030*BH*3  ...          1        NaN
6      1007    FHL*ROBI-TH-LP-230030*BH*2  ...          1        NaN
7      1008    FHL*ROBI-TH-LP-230030*LM*2  ...          1        NaN
8      1009    FHL*ROBI-TH-LP-230030*LM*3  ...          1        NaN
9      1010    FHL*ROBI-TH-LP-230030*BH*1  ...          1        NaN
10     1011    FHL*ROBI-TH-LP-230030*LM*1  ...          1        NaN
11     1012     FHL*Robi-LP-001358-5*BH*1  ...          1        NaN
12     1013     FHL*Robi-LP-001358-5*BH*2  ...          1        NaN
13     1014     FHL*Robi-LP-001358-5*BH*3  ...          1        NaN
14     1015     FHL*Robi-LP-001358-5*LM*1  ...          1        NaN
15     1016     FHL*Robi-LP-001358-5*LM*2  ...          1        NaN
16     1017     FHL*Robi-LP-001358-5*LM*3  ...          1        NaN
17     1018     SCL*Robi-LP-001855-4*BH*1  ...          1        NaN
18     1019     SCL*Robi-LP-001855-4*BH*2  ...          1        NaN
19     1020     SCL*Robi-LP-001855-4*LM*1  ...          1        NaN
20     1021     SCL*Robi-LP-001091-3*BH*1  ...          1        NaN
21     1022     SCL*Robi-LP-001091-3*LM*1  ...          1        NaN
22     1023     FHL*Robi-LP-001090-3*LM*1  ...          1        NaN
23     1024     FHL*Robi-LP-001090-3*LM*2  ...          1        NaN
24     1025     FHL*Robi-LP-001090-3*BH*3  ...          1        NaN
25     1026     SCL*Robi-LP-001855-1*BH*1  ...          1        NaN
26     1027     FHL*Robi-LP-001358-3*BH*1  ...          1        NaN
27     1028   SCL*Robi-LP-001855-7-1*LM*1  ...          1        Na...
------------------------------------------
# utils.crud_v2 - auto_upsert (START)
- inputs:
  engine: SQLAlchemyEngine(url=sqlite:///opflow.db)
  data: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  table: test_quota
  constrain: ['COST_ID']
  chunk: 10000
  add_missing_cols: True
  failure_threshold: 1
  semantic_meta: {'COST_CODE': 'STRING_OBJECT', 'VENDOR': 'STRING_OBJECT', 'CONTRACT': 'STRING_OBJECT', 'LINK_TYPE': 'STRING_OBJECT', 'REMARKS': 'STRING_OBJECT'}
  trace_sql: False

# utils.crud_v2 - auto_upsert (FAILURE)
- error: ValueError: constrain=['COST_ID'] does not match any primary/unique key on 'test_quota'. Upsert requires a unique constraint to be safe.
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(3, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string', 'CONTRACT': 'string', 'LINK_TYPE': 'string', 'BUCKET': 'integer', 'MIN_CAPACITY': 'integer', 'MAX_CAPACITY': 'integer', 'UNIT_COST_PER_MBPS_MONTHLY': 'float', 'MINSLAB': 'integer', 'LOCKIN_MONTHS': 'integer', 'REMARKS': 'string', 'EFFECTIVE_START_TIME': 'string', 'EFFECTIVE_END_TIME': 'string', 'IS_CURRENT': 'integer', 'CREATED_BY': 'float'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(3, 16)

 COST_ID                  COST_CODE VENDOR         CONTRACT LINK_TYPE  BUCKET  MIN_CAPACITY  MAX_CAPACITY  UNIT_COST_PER_MBPS_MONTHLY  MINSLAB  LOCKIN_MONTHS          REMARKS EFFECTIVE_START_TIME EFFECTIVE_END_TIME  IS_CURRENT  CREATED_BY
    3034  SCL*Robi-LP-001855-1*BH*2    SCL Robi-LP-001855-1        BH       2             1           100                       30.00    70000              1 No per mbps rate            9/12/2024           1/1/1970           1         NaN
    3035 SCL*Robi-LP-001855-6*MBH*1    SCL Robi-LP-001855-6       MBH       1             1        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    3036 SCL*Robi-LP-001855-7*MBH*1    SCL Robi-LP-001855-7       MBH       1         10000         20000                       78.26        0             12              NaN            9/12/2024           1/1/1970           1         NaN
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 3
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 3
}
------------------------------------------
# JSON - semantic_type_CONTRACT

{
  "column": "CONTRACT",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 3
}
------------------------------------------
# JSON - semantic_type_LINK_TYPE

{
  "column": "LINK_TYPE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 3
}
------------------------------------------
# JSON - semantic_type_REMARKS

{
  "column": "REMARKS",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 1
}
------------------------------------------
# JSON - semantic_type_EFFECTIVE_START_TIME

{
  "column": "EFFECTIVE_START_TIME",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 3
}
------------------------------------------
# JSON - semantic_type_EFFECTIVE_END_TIME

{
  "column": "EFFECTIVE_END_TIME",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 3
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "CONTRACT": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "LINK_TYPE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "BUCKET": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MIN_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MAX_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "UNIT_COST_PER_MBPS_MONTHLY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  },
  "MINSLAB": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "LOCKIN_MONTHS": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "REMARKS": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_START_TIME": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_END_TIME": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "IS_CURRENT": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "CREATED_BY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (   COST_ID                   COST_CODE  ... IS_CURRENT CREATED_BY
0     3034   SCL*Robi-LP-001855-1*BH*2  ...          1        NaN
1     3035  SCL*Robi-LP-001855-6*MBH*1  ...          1        NaN
2     3036  SCL*Robi-LP-001855-7*MBH*1  ...          1        NaN

[3 rows x 16 columns], {'COST_ID': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'COST_CODE': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'VENDOR': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'CONTRACT': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'LINK_TYPE': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'BUCKET': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'MIN_CAPACITY': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'MAX_CAPACITY': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'UNIT_COST_PER_MBPS_MONTHLY': {'input_dtype': 'float64', 'output_dtype': 'float64'}, 'MINSLAB': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'LOCKIN_MONTHS': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'REMARKS': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'EFFECTIVE_START_TIME': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'EFFECTIVE_END_TIME': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}, 'IS_CURRENT': {'input_dtype': 'int64', 'output_dtype': 'int64'}, 'CREATED_BY': {'input_dtype': 'float64', 'output_dtype': 'float64'}})
------------------------------------------
# utils.crud_v2 - auto_insert (START)
- inputs:
  engine: SQLAlchemyEngine(url=sqlite:///opflow.db)
  data: DataFrame(shape=(3, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  table: test_quota
  chunk_size: 10000
  add_missing_cols: True
  failure_threshold: 1
  semantic_meta: {'COST_CODE': 'STRING_OBJECT', 'VENDOR': 'STRING_OBJECT', 'CONTRACT': 'STRING_OBJECT', 'LINK_TYPE': 'STRING_OBJECT', 'REMARKS': 'STRING_OBJECT', 'EFFECTIVE_START_TIME': 'STRING_OBJECT', 'EFFECTIVE_END_TIME': 'STRING_OBJECT'}
  trace_sql: False

# utils.crud_v2 - auto_insert (SUCCESS)
- outputs:
  3
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(1, 1), columns=['COST_CODE'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string', 'CONTRACT': 'string', 'LINK_TYPE': 'string', 'BUCKET': 'integer', 'MIN_CAPACITY': 'integer', 'MAX_CAPACITY': 'integer', 'UNIT_COST_PER_MBPS_MONTHLY': 'float', 'MINSLAB': 'integer', 'LOCKIN_MONTHS': 'integer', 'REMARKS': 'string', 'EFFECTIVE_START_TIME': 'string', 'EFFECTIVE_END_TIME': 'string', 'IS_CURRENT': 'integer', 'CREATED_BY': 'float'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(1, 1)

                        COST_CODE
SCL*Robi-LP-001855-1*BH*2_UPDATED
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 1
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (                           COST_CODE
0  SCL*Robi-LP-001855-1*BH*2_UPDATED, {'COST_CODE': {'input_dtype': 'object', 'output_dtype': 'object', 'object_semantic_type': 'STRING_OBJECT'}})
------------------------------------------
# utils.crud_v2 - auto_update (START)
- inputs:
  engine: SQLAlchemyEngine(url=sqlite:///opflow.db)
  table: test_quota
  data: DataFrame(shape=(1, 1), columns=['COST_CODE'])
  where: [('COST_ID', '=', 1001)]
  expression: None
  add_missing_cols: False
  failure_threshold: 1
  semantic_meta: {'COST_CODE': 'STRING_OBJECT'}
  trace_sql: False

# utils.crud_v2 - auto_update (SUCCESS)
- outputs:
  0
------------------------------------------
# utils.casting - cast_df (START)
- inputs:
  obj: DataFrame(shape=(33, 16), columns=['COST_ID', 'COST_CODE', 'VENDOR', 'CONTRACT', 'LINK_TYPE', 'BUCKET', 'MIN_CAPACITY', 'MAX_CAPACITY', 'UNIT_COST_PER_MBPS_MONTHLY', 'MINSLAB', 'LOCKIN_MONTHS', 'REMARKS', 'EFFECTIVE_START_TIME', 'EFFECTIVE_END_TIME', 'IS_CURRENT', 'CREATED_BY'])
  dtype: {'cost_id': 'integer', 'cost_code': 'string', 'vendor': 'string', 'CONTRACT': 'string', 'LINK_TYPE': 'string', 'BUCKET': 'integer', 'MIN_CAPACITY': 'integer', 'MAX_CAPACITY': 'integer', 'UNIT_COST_PER_MBPS_MONTHLY': 'float', 'MINSLAB': 'integer', 'LOCKIN_MONTHS': 'integer', 'REMARKS': 'string', 'EFFECTIVE_START_TIME': 'string', 'EFFECTIVE_END_TIME': 'string', 'IS_CURRENT': 'integer', 'CREATED_BY': 'float'}
  return_dtype_meta: True
  kwargs: {'infer_threshold': 1}

# DATAFRAME - cast_df_input

shape=(33, 16)

 COST_ID                  COST_CODE VENDOR         CONTRACT LINK_TYPE  BUCKET  MIN_CAPACITY  MAX_CAPACITY  UNIT_COST_PER_MBPS_MONTHLY  MINSLAB  LOCKIN_MONTHS          REMARKS EFFECTIVE_START_TIME EFFECTIVE_END_TIME  IS_CURRENT  CREATED_BY
    1001  SCL*Robi-LP-001855-1*BH*2    SCL Robi-LP-001855-1        BH       2             1           100                       30.00    70000              1 No per mbps rate            9/12/2024           1/1/1970           1         NaN
    1002 SCL*Robi-LP-001855-6*MBH*1    SCL Robi-LP-001855-6       MBH       1             1        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1003 SCL*Robi-LP-001855-7*MBH*1    SCL Robi-LP-001855-7       MBH       1         10000         20000                       78.26        0             12              NaN            9/12/2024           1/1/1970           1         NaN
    1004 SCL*Robi-LP-001855-7*MBH*2    SCL Robi-LP-001855-7       MBH       2         10000         20000                       78.26        0             24              NaN            9/12/2024           1/1/1970           1         NaN
    1005 SCL*Robi-LP-001855-3*MBH*1    SCL Robi-LP-001855-3       MBH       1         10000        100000                       60.00        0             24              NaN            9/12/2024           1/1/1970           1         NaN
... (28 more rows)
------------------------------------------
# JSON - semantic_type_COST_CODE

{
  "column": "COST_CODE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_VENDOR

{
  "column": "VENDOR",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_CONTRACT

{
  "column": "CONTRACT",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_LINK_TYPE

{
  "column": "LINK_TYPE",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_REMARKS

{
  "column": "REMARKS",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 8
}
------------------------------------------
# JSON - semantic_type_EFFECTIVE_START_TIME

{
  "column": "EFFECTIVE_START_TIME",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - semantic_type_EFFECTIVE_END_TIME

{
  "column": "EFFECTIVE_END_TIME",
  "semantic_type": "STRING_OBJECT",
  "sample_size": 33
}
------------------------------------------
# JSON - dtype_transitions

{
  "COST_ID": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "COST_CODE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "VENDOR": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "CONTRACT": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "LINK_TYPE": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "BUCKET": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MIN_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "MAX_CAPACITY": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "UNIT_COST_PER_MBPS_MONTHLY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  },
  "MINSLAB": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "LOCKIN_MONTHS": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "REMARKS": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_START_TIME": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "EFFECTIVE_END_TIME": {
    "input_dtype": "object",
    "output_dtype": "object",
    "object_semantic_type": "STRING_OBJECT"
  },
  "IS_CURRENT": {
    "input_dtype": "int64",
    "output_dtype": "int64"
  },
  "CREATED_BY": {
    "input_dtype": "float64",
    "output_dtype": "float64"
  }
}
------------------------------------------
# utils.casting - cast_df (SUCCESS)
- outputs:
  (    COST_ID                     COST_CODE  ... IS_CURRENT CREATED_BY
0      1001     SCL*Robi-LP-001855-1*BH*2  ...          1        NaN
1      1002    SCL*Robi-LP-001855-6*MBH*1  ...          1        NaN
2      1003    SCL*Robi-LP-001855-7*MBH*1  ...          1        NaN
3      1004    SCL*Robi-LP-001855-7*MBH*2  ...          1        NaN
4      1005    SCL*Robi-LP-001855-3*MBH*1  ...          1        NaN
5      1006    FHL*ROBI-TH-LP-230030*BH*3  ...          1        NaN
6      1007    FHL*ROBI-TH-LP-230030*BH*2  ...          1        NaN
7      1008    FHL*ROBI-TH-LP-230030*LM*2  ...          1        NaN
8      1009    FHL*ROBI-TH-LP-230030*LM*3  ...          1        NaN
9      1010    FHL*ROBI-TH-LP-230030*BH*1  ...          1        NaN
10     1011    FHL*ROBI-TH-LP-230030*LM*1  ...          1        NaN
11     1012     FHL*Robi-LP-001358-5*BH*1  ...          1        NaN
12     1013     FHL*Robi-LP-001358-5*BH*2  ...          1        NaN
13     1014     FHL*Robi-LP-001358-5*BH*3  ...          1        NaN
14     1015     FHL*Robi-LP-001358-5*LM*1  ...          1        NaN
15     1016     FHL*Robi-LP-001358-5*LM*2  ...          1        NaN
16     1017     FHL*Robi-LP-001358-5*LM*3  ...          1        NaN
17     1018     SCL*Robi-LP-001855-4*BH*1  ...          1        NaN
18     1019     SCL*Robi-LP-001855-4*BH*2  ...          1        NaN
19     1020     SCL*Robi-LP-001855-4*LM*1  ...          1        NaN
20     1021     SCL*Robi-LP-001091-3*BH*1  ...          1        NaN
21     1022     SCL*Robi-LP-001091-3*LM*1  ...          1        NaN
22     1023     FHL*Robi-LP-001090-3*LM*1  ...          1        NaN
23     1024     FHL*Robi-LP-001090-3*LM*2  ...          1        NaN
24     1025     FHL*Robi-LP-001090-3*BH*3  ...          1        NaN
25     1026     SCL*Robi-LP-001855-1*BH*1  ...          1        NaN
26     1027     FHL*Robi-LP-001358-3*BH*1  ...          1        NaN
27     1028   SCL*Robi-LP-001855-7-1*LM*1  ...          1        Na...
------------------------------------------
# utils.crud_v2 - auto_insert (START)
- inputs:
  engine: SQLAlchemyEngine(url=sqlite:///opflow.db)
  data: DataFrame(shape=(33, 16), columns=['cost_id', 'cost_code', 'vendor', 'contract', 'link_type', 'bucket', 'min_capacity', 'max_capacity', 'unit_cost_per_mbps_monthly', 'minslab', 'lockin_months', 'remarks', 'effective_start_time', 'effective_end_time', 'is_current', 'created_by'])
  table: test_quota
  chunk_size: 10000
  add_missing_cols: False
  failure_threshold: 1
  semantic_meta: {'COST_CODE': 'STRING_OBJECT', 'VENDOR': 'STRING_OBJECT', 'CONTRACT': 'STRING_OBJECT', 'LINK_TYPE': 'STRING_OBJECT', 'REMARKS': 'STRING_OBJECT', 'EFFECTIVE_START_TIME': 'STRING_OBJECT', 'EFFECTIVE_END_TIME': 'STRING_OBJECT'}
  trace_sql: False

# utils.crud_v2 - auto_insert (SUCCESS)
- outputs:
  33
------------------------------------------
